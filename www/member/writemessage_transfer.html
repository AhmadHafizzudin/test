<div class="row" >
   <form role="form" name="myForm"  method="post">
      <div class="form-group">
         <div class="col-md-6 col-md-offset-3" >
            <div class="panel panel-default">
               <div class="panel-body">
                  <image width="90px" height="100px"  class="img-circle" id="userpic"/>
                  <span>&nbsp;via </span>
                  <image width="10%"  id="usersocial" class="img-circle"/>
                  <p></p>
                  <label for="moneybalance">Receiver Name</label>
                  <input type="text" name="receiver" id="receiver" class="form-control"   >
                  <p></p>
                  <label for="type">Asset Type</label>
                  <input type="text" name="type" id="type" class="form-control"  readonly>
                  <p></p>
                  <label for="totalweight">Total Weight (Gram) / Amount (MYR)</label>
                  <input type="text" name="totalweight" id="totalweight" class="form-control" readonly>
                  <p></p>
                  <textarea rows="4" cols="50" class="form-control" name="message" id="message" placeholder="Write your message here.."></textarea>
                  <p></p>
                  <img id="item" src="#" alt="your image" style="width:100px;height:100px;display:none;"/>
                  <p></p>
                 <!-- <a href="#upload" data-toggle="collapse" style="text-decoration:none">
                  <img src="assets/images/paperclip.png" width="25%"  class="img-circle" alt="Add attachment"/>
                  </a>-->
                  <div class="image-upload">
                     
                        <label for="camera_src" class="label-upload">
                        <img src="assets/images/camera.png" style="width:70px;height:70px;"  class="img-circle" alt="Camera"/>
                        </label>
                        <input type="file"  name="camera_src" id="camera_src"  accept="image/*" capture="camera" onchange="readURL(this);">
                        
                        <label for="gallery_src" class="label-upload">
                        <img src="assets/images/gallery.png" style="width:70px;height:70px;"  class="img-circle" alt="Gallery"/>
                        </label>
                        <input type="file"  name="gallery_src" id="gallery_src"  accept="image/*" capture onchange="readURL(this);">
                        
                      <!--  <label for="audio_src">
                        <img src="assets/images/sound.png" width="25%"  class="img-circle" alt="Add attachment"/>
                        </label>
                        <input type="file"  name="audio_src" id="audio_src"  accept="audio/*" capture onchange="readURL(this);">-->
                     
                  </div>
                  <p></p>
                  <p></p>
                  <p></p>
                  <div align="center">
                     <input type="button" name="buttonNext" id="buttonNext" value="Next" class="btn myButton-blue" onclick="return validateForm()">
                  </div>
               </div>
            </div>
         </div>
      </div>
   </form>
</div>
<script src="assets/js/member/writemessage_transfer.js"></script>
<!--<script>
   $("[data-toggle='toggle']").click(function () {
       var selector = $(this).data("target");
       $(selector).toggleClass('in');
   });
</script>

<script>
   function readURL(input) {
    var $prev = $('#item'); // cached for efficiency

    if (input.files && input.files[0]) {
        var reader = new FileReader();

        reader.onload = function (e) {
            $prev.attr('src', e.target.result);
        }

        reader.readAsDataURL(input.files[0]);

        $prev.show(); // this will show only when the input has a file
    } else {
        $prev.hide(); // this hides it when the input is cleared
    }
}
</script>
<script>
function validateForm() {
    var x = document.forms["myForm"]["message"].value;

    if (x == null || x == "") {
        msg_alert('Please write your message', 2);
        return false;
        x.focus();

    }else{

    var newMessage = new Array();
    

    newMessage[0] = document.getElementById("message").value;  

// store array data to the session storage
sessionStorage.setItem("newMessage",  JSON.stringify(newMessage));

//Use JSON to retrieve the stored data and convert it 
var storedData = sessionStorage.getItem("newMessage");
if (storedData) {
  newMessage = JSON.parse(storedData);
}
      pass_url('member/confirm_transfer.html');
    
}    
}
</script>
<script type="text/javascript">

if(sessionStorage.length > 0) {
    for (i=0; i<=sessionStorage.length-1; i++)  
    {   
        key = sessionStorage.key(i);  
        val = sessionStorage.getItem("newReceiver");
        val2 = sessionStorage.getItem("newItem"); 
        val3 = sessionStorage.getItem("selgold");
        val4 = sessionStorage.getItem("selsilver"); 
        val5 = sessionStorage.getItem("newMoney");      
    }
var newVal = val.replace(/[\]\[\"\']+/g,'');
var newVal3 = val2.replace(/[\]\[\"\']+/g,'');
var newVal4= [];
var newVal5= [];
newVal4 = JSON.parse(val3);
newVal5 = JSON.parse(val4);
newVal6 = JSON.parse(val5);

var name = newVal.split(",")[0];
var social = newVal.split(",")[1];
var pic = newVal.split(",")[2];
var type = JSON.parse(val2);


document.getElementById("receiver").value =  name;
document.getElementById("userpic").src =  pic;
document.getElementById("usersocial").src =  social;

document.getElementById("type").value =  type;
var total = 0;

var newType = document.getElementById("type").value;

if (newType == "Gold"){

$.ajax({ //display list of gold
                 url: 'http://localhost/dpapps/index.php/sendpayment/listAllGold/',
                 type:'POST',
                 dataType: 'json',
                 error: function(error_data){
                 console.log(error_data);
                 },
                 success: function(data){

                $.each(data.results, function(index,item){
                
                  for (var i = 0; i < newVal4.length; i++) {
                    
                        if (newVal4[i] == item.gacc_id) {
                            total += parseFloat(item.gacc_weight);
                        }
                    
                }
                

                });  
                              
                 
// store array data to the session storage
sessionStorage.setItem("transvalue",  JSON.stringify(total));


document.getElementById("totalweight").value =  total;

} // End of success function of ajax form
             }); // End of second ajax call (gold)

}else if(newType == "Silver"){

  $.ajax({ //display list of gold
                 url: 'http://localhost/dpapps/index.php/sendpayment/listAllSilver/',
                 type:'POST',
                 dataType: 'json',
                 error: function(error_data){
                 console.log(error_data);
                 },
                 success: function(data){

                $.each(data.results, function(index,item){
                
                  for (var i = 0; i < newVal5.length; i++) {
                    
                        if (newVal5[i] == item.sacc_id) {
                            total += parseFloat(item.sacc_weight);
                        }
                    
                }
                

                });  
                              
// store array data to the session storage
sessionStorage.setItem("transvalue",  JSON.stringify(total));

document.getElementById("totalweight").value =  total;

} // End of success function of ajax form
             }); // End of second ajax call (gold)

}else{



  document.getElementById("totalweight").value =  newVal6;

  sessionStorage.setItem("transvalue",  JSON.stringify(newVal6));


}

}
</script>
